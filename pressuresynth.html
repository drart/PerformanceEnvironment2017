<html>
    <head>
        <script src="node_modules/flocking/dist/flocking-all.min.js"></script>
        <script src="node_modules/pressure/dist/pressure.min.js"></script>
        <style>
            html, body {
                    overflow: hidden;
            },
            #playme{
                visibility: hidden;
            }
        </style>
    </head>
    <body>
        <button id="playme">Play audio</button>
        <div id="pressure"></div>
        <div id="mousex"></div>
        <div id="mousey"></div>
        <script>
            var clckd = false;

            Pressure.set('body', {
                change: function(force){
                    document.getElementById("pressure").innerHTML = force;
                    granny.set("granny.mul.mul", force);
                }
            });

            function printMousePos(event) {
                event.preventDefault();
                if (clckd){
                    document.getElementById("mousex").innerHTML = event.clientX;
                    document.getElementById("mousey").innerHTML = event.clientY;
                    //console.log( "clientX: " + event.clientX + " - clientY: " + event.clientY);
                    //granny.set("granny.", event.clientX /1000 + 0.01 )
                    granny.set("granny.freq.freq", event.clientY + 200)
                }
            }

            document.addEventListener("mousedown", function(e){
                clckd = true;
            });
            document.addEventListener("mouseup", function(e){
                clckd = false;
            });
            document.addEventListener("touchstart", function(e){
                clckd = true;
            });
            document.addEventListener("touchend", function(e){
                clckd = false;
            });
            document.addEventListener("mousemove", printMousePos);
            document.addEventListener("touchmove", function(event){
                event.preventDefault();
                if (clckd){
                    document.getElementById("mousex").innerHTML = event.touches[0].clientX;
                    document.getElementById("mousey").innerHTML = event.touches[0].clientY;
                    //console.log( "clientX: " + event.clientX + " - clientY: " + event.clientY);
                    //granny.set("granny.", event.clientX /1000 + 0.01 )
                    granny.set("granny.freq.freq", event.touches[0].clientY + 200)
                }
            });

            var granny = flock.synth({
                synthDef: {
                    id: "granny",
                    ugen: "flock.ugen.sinOsc",
                    freq: {
                        ugen: "flock.ugen.sinOsc",
                        freq: 200,
                        mul: 300,
                        add: 500
                    },
                    mul: {
                        ugen: "flock.ugen.sinOsc",
                        mul: 0,
                        add: 0.5
                    }
                }
            });

            flock.init();
            //granny.play();
            document.addEventListener("DOMContentLoaded", function(event){
                document.getElementById("playme").style.visibility = "visible";
                document.getElementById("playme").addEventListener("click", function(event){
                    granny.play();
                    document.getElementById("playme").style.visibility = "hidden";
                });
            });
        </script>
    </body>
</html>
